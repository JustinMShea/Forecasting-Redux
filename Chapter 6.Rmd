---
title: "Chapter 6"
subtitle: "Introduction to Time Series"
author: ""
date: ""
output:
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
link-citations: yes
---

```{r setup, include=FALSE}
library(tufte)
# invalidate cache when the tufte version changes
knitr::opts_chunk$set(tidy = FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```

The preceding three chapters of this book dealt with regression methods applied to cross sectional data. When we have cross sectional data our approach to forecasting is to use the
explanatory variables to forecast the value of the dependent variable. This approach to forecasting is often termed _interpolation_.


The other broad method of quantitative business forecasting is to use the history of the data we wish to forecast. We examine the historical pattern of the data we wish to forecast and try to find a discernible pattern. Using this pattern, we forecast forward the future pattern of the data. This method of forecasting is often termed _extrapolation_. The use of the historical pattern of the data to be forecast is known as _time series methods_.

\newpage

# Stage 1 Collection and Analysis of Times Series Data

> "The future lies ahead."
>
> `r tufte::quote_footer('--- Mort Sahl')`

   A time series of data is data collected sequentially over equal periods of time. There are many forms of time series data. Time series can be collected as daily data (such as the daily closing price of a stock), weekly (such as weekly receipts data), monthly (such as monthly sales data), quarterly (such as quarterly revenue data), or yearly (such as annual profits data).

   Remember though, the time period of data collection must be consistent. If our time series data are both in monthly and quarterly form then forecasting can be exceedingly difficult. When one collects time series data, be certain that the time period of collection will remain consistent.

   To create a time series of data from our example of Sales Volume data we now collect a series of Sales Volume data from _just one location over consecutive monthly periods_. We collected a data set of four years, or 48 consecutive months (48 periods), of Sales Volume.



```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## Import data from table 6.1 text file
Table_61_path <- path.expand("~/R/forecasting/Table 6.1.txt")
table_61 <- read.delim(Table_61_path, header = FALSE, sep = " ", skip = 1)
 # add column names
colnames(table_61) <- c("Period", "Year 1", "Period", "Year 2", "Period", "Year 3", "Period", "Year 4")

library(knitr)
kable(table_61, caption = "Four Years of Time Series Data")
```

\newpage

## Graphically displaying Time Series Data: Time Series Plot

The corresponding _time series plot_ or _time series graph_ of the Sales Volume is in Figure 6-1 below.

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## Page 3, create plot
 # First, gather the time series data table into one column.
library(tidyr)
table_61_series <- gather(table_61, Period)
table_61_series <- table_61_series[,-(2:5)]
table_61_series$Period <- as.numeric(rownames(table_61_series))
colnames(table_61_series) <- c("Period", "Sales Volume")

 #Creat chjart
library(ggplot2)
library(ggthemes)
library(cowplot)

figure_61 <- ggplot(data = table_61_series, aes(y = `Sales Volume`, x = Period)) +
        geom_line() + 
        ylim(0,800) + 
        scale_x_continuous(breaks=seq(0,54,6), limits = c(0,54)) +
        ggtitle("Figure 6.1: Sales Volume") 

ggdraw(switch_axis_position(figure_61 + theme_tufte(), axis = 'y'))

```



## Tips on Graphing Times Series Data: The Practice

   Good graphical presentations of time series data and forecasts is useful and powerful in the presentation of ideas. A good layout for a time series graph is always helpful in the data analysis, model fitting, and forecasting.

   Notice in our graph, that we allowed for additional space to the right of the last observation of our data series. We have 48 observations but allowed for 54 observations. Notice too that because the time series graph reveals an upward direction of the data series
we also allowed for additional space above the last observation. The value of the last observation is 677.4 but allowed for values up to 800. In other words we have provided for plenty of "white space" for our graph.

   Along the horizontal or time period axis we created horizontal reference lines at every six periods. It would be too dense to create horizontal reference lines at every of 54 periods. And it would be too sparse to form lines at every 12th period. These are monthly data so every 6 periods denotes a half year. Period 6 is a June, Period 12 is a December, Period 18 is June again, and so on.

   Along the vertical or Sales Volume axis we set vertical reference lines at every 100 units. Units of 100 allow for sufficient spacing so the graph does not become crowded, and yet detailed enough so that we can estimate values with reasonable accuracy.

   In summary, when producing time series graph, try to make the graphs uncluttered
without sacrificing accuracy or information.

\newpage

## Time Series Data: Time Series Notation


When discussing observations in our data set we think of the data in the form
```{marginfigure}
Past or historical observations

$\dotso$, $Y_{T-1}$, $Y_{T-2}$, $Y_{T-3}$
```
```{marginfigure}
Most recent observation

$Y_T$
```
```{marginfigure}
Future observation

$Y_{T+1}$, $Y_{T+2}$, $Y_{T+3}$, $\dotso$
```
$$Y_1, Y_2, Y_3, ..., Y_T$$

$Y_1$ is the first observation, $Y_2$ is the second observation, and so on. is the oldest observation down through $Y_T$ which is the most recent observation. In our example data series:

$$Y_1 = 95.5$$
$$Y_2 = 127.0$$
$$Y_3 = 118.0$$
$$\vdots$$
$$Y_{48} = 677.4$$


The uppercase letter $T$ of $Y_T$ will always mean the most recent observation in our time series. $Y_{T+1}$ means then an observation one period into the future. Thus, $Y_{T+1}$, $Y_{T+2}$, $Y_{T+3}$, denote future observations one, two, and three periods beyond the present time $Y_T$. Similarly, $Y_{T-1}$ denotes an observation one period in the past, so that $Y_{T-1}$, $Y_{T-2}$, $Y_{T-3}$, denote observations one, two, and three periods in the past.


We can generalize this notation to:  

$Y_{T+\ell}$: A future observation of $\ell$ periods ahead.  

$Y_{T-\ell}$: A historical observation of $\ell$ periods back.


As we distinguish between $Y_i$ and $\hat{Y_i}$ in regression models, we shall destinguish between $Y_{T+\ell}$ and $\hat{Y_T}{\ell}$ in time series models.

$Y_{T+\ell}$ is the future observation of $Y$, $\ell$ period ahead,
and unkown at time $T$.


$\hat{Y_T}{\ell}$ is the forecast of the future observation, 
$\ell$ periods ahead, made at time $T$.


## Stage 1 Continued: The Theory of Collecting & Analyzing Data

We devote most of this chapter to Stage 1 of the Forecasting Process. With time series we recommend considerable investigation and analysis, to really understand the time series data, to really understand what the data are “telling us" before attempting to develop forecasting models. Consequently we shall begin this time series analysis with some easy, straightforward methods of analysis.

## Smoothing Out Time Series Data

Almost all time series data are rough, having a stochastic element to the series. We
shall discuss methods of "smoothing out" the data so that we may observe an underlying
structure or pattern. The first, and simplest, method of smoothing time series data is through averaging.

## Smoothing Out the Data by Averaging

If we believe there exists some underlying trend or pattern in the time series data,
then by “smoothing the data" we smooth out (or average out) the random variations to reveal
the underlying pattern in the series.

## The Practice: Simple Average Smoothing

We begin with a time series of 30 observations, $T = 30$, which has a constant
mean, or a slowly changing mean, over time, we call this "horizontal data". 
As in Table 6.2 and Figure 6.3.

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
 # Import data from table 6.2 text file
Table_62_path <- path.expand("~/R/forecasting/Table 6.2.txt")
table_62 <- read.delim(Table_62_path, header = FALSE, sep = " ", skip = 1)
 # add column names
colnames(table_62) <- c("Period", "Actual", "Period", "Actual")
library(knitr)
kable(table_62, caption = "Horizontal Data: Table 6.2")
```

\newpage

```{r, fig.width = 5, fig.height = 2.15, fig.fullwidth = TRUE, fig.cap = "Horizontal Data.", message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## Page 3, create plot
# First, gather the time series data table into one column.
library(tidyr)
table_62_series <- gather(table_62[,c(2,4)])
table_62_series$key<- as.numeric(rownames(table_62_series))
colnames(table_62_series) <- c("Period", "Horizontal Data")

 #Creat chart
#Creat chart
library(ggplot2)
figure_621 <- ggplot(data = table_62_series, aes(y = `Horizontal Data`, x = Period)) 

ggdraw(switch_axis_position(figure_621 + theme_tufte() , axis = 'y'))
```


Becuase the $Y_t$ are varying around a constant mean, a first smoothing of $Y_t$ is just its mean, $\bar{Y}$.^[$$\bar{Y} = \sum_{t=1}^{T} Y_{t}$$] In this example, $\bar{Y} = `r round(mean(table_62_series[,2]), digits = 1)`$.



```{r, fig.width = 5, fig.height = 2.15, fig.fullwidth = TRUE, fig.cap = "Horizontal Data with Plotted Mean.", message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
figure_622 <- ggplot(data = table_62_series, aes(y = `Horizontal Data`, x = Period))  +
        geom_hline(aes(yintercept=356.5), color = "red", linetype="dashed")

ggdraw(switch_axis_position(figure_622 + theme_tufte(), axis = 'y'))
```




\newpage

# Moving Average Smoothings

   The simple average discussed above is a smoothing method over all observations.
A _moving average_ is the technique of creating successive new averages by dropping the
"oldest" observation and adding the most recent observation to calculate the new average.

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## Smoothing moving average, pg 8.
period_3_example <- table_62_series[6:8,]
smooth <- round(mean(table_62_series[6:8,2]), digits = 2)
period_3_example$Smoothing <- c("...",smooth,"...")
colnames(period_3_example) <- c("Period", "Actual", "Smoothing")
```

## 3-period Centered Moving Average Smoothing for period $t$

To begin with an example, examine the notation in the margin^[3-period Centered Moving Average: $$CMA_{t}(3) = \frac{Y_{T+1}+Y_{T}+Y_{T-1}}{3}$$]. Next, we shall use the data from Table 6.2 to illustrate this method. For example, a 3-period Centered Moving Average (at period 7) is:

$CMA_{7}(3) = \frac{Y_{8}+Y_{7}+Y_{6}}{3}$

$CMA_{7}(3) = \frac{364+367+375}{3} = `r smooth`$

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## creating table 63
library(forecast)
smooth_63 <- round(ma(table_62_series[,2], order = 3, centre = TRUE), digits = 1)
table_63_series <- data.frame(table_62_series, "CMA(3)" = smooth_63)
colnames(table_63_series) <- c("Period", "Actual", "Centered Moving Average (3)")
table_63 <- data.frame(table_63_series[1:15,], table_63_series[16:30,])
colnames(table_63) <- c("Period", "Actual", "CMA(3)", "Period", "Actual", "CMA(3)")
```

```{r, fig.margin = TRUE, fig.cap = "Centered Moving Average(3)", fig.width=4, fig.height=3.5, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
table_63_chart <- table_63_series
colnames(table_63_chart) <- c("Period", "Actual", "CMA(3)")
table_63_chart <- gather(table_63_chart, Period)
colnames(table_63_chart) <- c("Period", "Series", "Value")

chart_63 <- ggplot(data = table_63_chart, aes(y = Value, x = Period, col = Series)) +
            geom_line(position = "jitter") 
        
ggdraw(switch_axis_position(chart_63 + theme_tufte() +
            theme(legend.position = "top"), axis = 'y'))
```


```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
kable(period_3_example, align = "r", row.names=FALSE, caption="Horizontal Data Table 6.2: CMA(3)")
```

   This smoothing method is called a 3-period centered moving average because the computed value is placed at the center, or middle, of the 3 periods being used in the calculations.
   

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
kable(table_63, align = "l", row.names=FALSE, caption="Table 6.3: 
Centered Smoothing Average (3)")
```

```{r, fig.cap = "CMA(3), expanded.", message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE, fig.width = 10, fig.height = 5, fig.fullwidth = TRUE}
ggdraw(switch_axis_position(chart_63 + ggtitle("Centered Moving Average(3)") + theme_tufte() +  theme(legend.position = "bottom"), axis = 'y'))
```


\newpage

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## Smoothing moving average, pg 8.
period_5_example <- table_62_series[4:10,]
smooth5 <- round(mean(table_62_series[5:9,2]), digits = 2)
period_5_example$Smoothing <- c("...","...","...",smooth5,"...","...","...")
colnames(period_5_example) <- c("Period", "Actual", "Smoothing")
```

## 5-period Centered Moving Average Smoothing for period $t$


A 5 period moving average smoothing is “smoother" than a 3 period because it uses
a larger set of observations.^[5-period Centered Moving Average: $$CMA_{t}(5) = \frac{Y_{T+2}+Y_{T+1}+Y_{T}+Y_{T-1}+Y_{T-2}}{5}$$]. As an example we smooth period 7 of the data in Table 6.3.

$$CMA_{7}(5) = \frac{Y_{9}+Y_{8}+Y_{7}+Y_{6}+Y_{5}}{5}$$

$$CMA_{7}(5) = \frac{379+364+367+375+375}{5} = `r smooth5`$$


```{r, fig.margin = TRUE, fig.cap = "Centered Moving Average(5)", fig.width=4, fig.height=3.5, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
library(forecast)
smooth_64 <- round(ma(table_62_series[,2], order = 5, centre = TRUE), digits = 1)
table_64_series <- data.frame(table_62_series, "CMA(3)" = smooth_63, "CMA(5)" = smooth_64)
colnames(table_64_series) <- c("Period", "Actual", "CMA(3)", "CMA(5)")

table_64 <- data.frame(table_64_series[1:15,], table_64_series[16:30,])
colnames(table_64) <- c("Period", "Actual", "CMA(3)","CMA(5)","Period", "Actual", "CMA(3)", "CMA(5)")

library(ggplot2)
table_641_chart <- table_64_series[,c(1,2,4)]
table_641_chart <- gather(table_641_chart, Period)
colnames(table_641_chart) <- c("Period", "Series", "Value")

margin_chart_64 <- ggplot(data = table_641_chart, aes(y = Value, x = Period, col = Series)) +
  geom_line(position = "jitter")

ggdraw(switch_axis_position(margin_chart_64 + theme_tufte() +
            theme(legend.position = "top"), axis = 'y'))
```
```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
kable(period_5_example, align = "l", row.names=FALSE, caption="6.3 subset: Centered Smoothing Average (5)")
```

We list below both the 3 and 5 period moving average smoothing.


```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## creating table 6.4
library(forecast)
smooth_64 <- round(ma(table_62_series[,2], order = 5, centre = TRUE), digits = 1)
table_64_series <- data.frame(table_62_series, "CMA(3)" = smooth_63, "CMA(5)" = smooth_64)
colnames(table_64_series) <- c("Period", "Actual", "CMA(3)", "CMA(5)")

table_64 <- data.frame(table_64_series[1:15,], table_64_series[16:30,])
colnames(table_64) <- c("Period", "Actual", "CMA(3)","CMA(5)","Period", "Actual", "CMA(3)", "CMA(5)")

kable(table_64, align = "l", row.names=FALSE, caption="Table 6.4: 
Centered Smoothing Average (3) & (5)")
```
   
\newpage

Below is a graph of actual values along with 5-period smoothing.
```{r, fig.fullwidth = TRUE, fig.cap = "Centered Moving Average(5)", fig.width = 10, fig.height = 4,  message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
table_641_chart <- table_64_series[,c(1,2,4)]
table_641_chart <- gather(table_641_chart, Period)
colnames(table_641_chart) <- c("Period", "Series", "Value")

chart_641 <- ggplot(data = table_641_chart, aes(y = Value, x = Period, col = Series)) +
  geom_line(position = "jitter") +
  ggtitle("Actual ~ Centered Moving Average(5)") 

ggdraw(switch_axis_position(chart_641 + theme_tufte() +
            theme(legend.position = "bottom"), axis = 'y'))
```
This next graph has both 3 and 5 period smoothings superimposed.
```{r, fig.fullwidth = TRUE, fig.cap = "Centered Moving Average(3,5)", fig.width = 10, fig.height = 4, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
# chart 2
table_642_chart <- table_64_series
table_642_chart <- gather(table_642_chart, Period)
colnames(table_642_chart) <- c("Period", "Series", "Value")

chart_642 <- ggplot(data = table_642_chart, aes(y = Value, x = Period, col = Series)) +
  geom_line(position = "jitter") +
  ggtitle("Actual ~ Centered Moving Average (3) and (5)") 

ggdraw(switch_axis_position(chart_642 + theme_tufte() +
            theme(legend.position = "bottom"), axis = 'y'))
```

\newpage
## 4-Period Centered Moving Average Smoothing

A 4-period Centered Moving Average is possible, but the issue of the placing of the results remains.^[4-period Centered Moving Average: $$CMA_{t}(4) = \frac{Y_{T+2}+2Y_{T+1}+2Y_{T}+2Y_{T-1}+Y_{T-2}}{8}$$] 

```{r, fig.margin = TRUE, fig.cap = "Centered Moving Average(4)", fig.width=4, fig.height=3.5, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
library(forecast)
smooth_65 <- round(ma(table_62_series[,2], order = 4, centre = TRUE), digits = 2)
table_65 <- data.frame(table_62_series, "CMA(4)" = smooth_65)
colnames(table_65) <- c("Period", "Actual", "CMA(4)")

table_65_table <- data.frame(table_65[1:15,], table_65[16:30,])
colnames(table_65_table) <- c("Period", "Actual", "CMA(4)","Period", "Actual", "CMA(4)")

# table for chart
table_65_chart <- gather(table_65, Period)
colnames(table_65_chart) <- c("Period", "Series", "Value")

chart_65 <- ggplot(data = table_65_chart, aes(y = Value, x = Period, col = Series)) +
            geom_line(position = "jitter")

ggdraw(switch_axis_position(chart_65 + theme_tufte() +
            theme(legend.position = "top"), axis = 'y'))
```

Technically, if (say) the first 4 periods are used, 
$$CMA_{t}(4) = \frac{Y_{4}+Y_{3}+Y_{2}+Y_{1}}{4}$$
then the placement of $CMA_{t}(4)$ is between periods 2 and 3 at "period 2.5."
$$CMA_{t}(4) = \frac{389+329+368+354}{4} = 360$$
The next 4-period centered smoothing is placed at "period 3.5"
$$CMA_{t}(4) = \frac{Y_{5}+Y_{4}+Y_{3}+Y_{2}}{4}$$
$$CMA_{t}(4) = \frac{375+389+329+368}{4} = 365.25$$

Then the "adjusted centered smoothing" for period 3 is the average of period 2.5 and period 3.5 smoothing. Algebraically, it can be shown that the adjusted moving average of 4 periods, starting with period $t = 3$ is shown.
$$CMA_{t}(4) = \frac{360+365.25}{2} = 362.63$$
The 4-period Centered Moving Average Smoothing is especially suited for quarterly time series. However, the Centered Moving Average Smoothing formula may be generalized to any even number of periods.

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE, fig.margin = TRUE}
## creating table 6.5
kable(table_65_table, align = "l", row.names=FALSE, caption="Table 6.5: 
Centered Smoothing Average (4)")
```

\newpage

## 6-Period Centered Moving Average Smoothing

$$CMA_{t}(6) = \frac{Y_{T+2}+2Y_{T+2}+2Y_{T+1}+2Y_{T}+2Y_{T-1}+2Y_{T-2}+Y_{T-3}}{12}$$

## 12-Period Centered Moving Average Smoothing

$CMA_{t}(12) = \frac{Y_{T+6}+2Y_{T+5}+2Y_{T+4}+2Y_{T+3}+2Y_{T+2}+2Y_{T+1}+2Y_{T}+2Y_{T-1}+2Y_{T-2}+Y_{T-3}+2Y_{T-4}+2Y_{T-5}+Y_{T-6}}{24}$


Not all smoothings must be placed in the “center" of the data, we have done so
because a moving average falls in the “middle" of the data. However, for example, some 4-
period weekly smoothings are placed at the last period of the four periods smoothed.

The length of periods of smoothing is usually dependent on the type of time series
data being analyzed. For example, some analyses of stock market and bond market time
series data use 13-period and 39-period smoothing of weekly data.



```{r, fig.fullwidth = TRUE, fig.cap = "Centered Moving Average(6,12)", fig.width = 10, fig.height = 4, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
library(forecast)
smooth_6 <- round(ma(table_62_series[,2], order = 6, centre = TRUE), digits = 1)
smooth_12 <- round(ma(table_62_series[,2], order = 12, centre = TRUE), digits = 1)

table_66_series <- data.frame(table_62_series, "CMA(6)" = smooth_6, "CMA(12)" = smooth_12)
colnames(table_66_series) <- c("Period", "Actual", "CMA(6)", "CMA(12)")

# chart 2
table_66_chart <- gather(table_66_series, Period)
colnames(table_66_chart) <- c("Period", "Series", "Value")

chart_66 <- ggplot(data = table_66_chart, aes(y = Value, x = Period, col = Series)) +
  geom_line(position = "jitter") +
  ggtitle("Actual ~ Centered Moving Average (6) and (12)") 

ggdraw(switch_axis_position(chart_66 + theme_tufte() +
            theme(legend.position = "bottom"), axis = 'y'))
```

\newpage


# Weighted Moving Average Smoothings

Simple moving averages assume equal weight to the observations being used in the
calculations. There may be situations, however, in which it is better to assign greater weight
to the most recent observation and less to observations in the past.

## 3-period Centered Weighted Moving Average

A 3-period Centered Weighted Moving Average is denoted as $CWMA(3)$ and can be found in the margin.^[3-period Centered Weighted Moving Average: $$CWMA_{t}(3) = \frac{\omega_1 Y_{T+1}+\omega_2 Y_{T}+\omega_3 Y_{T-1}}{3}$$]

As an example, consider the following notation:

$$CWMA_{t}(3) = \frac{0.6 Y_{T+1}+0.3 Y_{T}+0.1 Y_{T-1}}{3}$$

In general terms, we denote the weights by $\omega_1$, $\omega_2$, and $\omega_3$ (omega sub 1, omega sub 2, and omega sub 3)

A weighted moving average may be generalized to any number of historical periods and set of weights. The choice of the number of historical periods and the weights used are determined, in part, by the Forecast Analyst who has collected the data and has some appreciation of the data structure.

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
## creating table 67
library(TTR)
smooth_67 <- round(WMA(table_62_series[,2], n = 3), digits = 1)
table_67_series <- data.frame(table_62_series, "CWMA(3)" = smooth_67)
colnames(table_67_series) <- c("Period", "Actual", "CWMA(3)")
table_67 <- data.frame(table_67_series[1:15,], table_67_series[16:30,])
colnames(table_63) <- c("Period", "Actual", "CWMA(3)", "Period", "Actual", "CWMA(3)")
```

```{r, fig.margin = TRUE, fig.cap = "Centered Weighted Moving Average(3)", fig.width=4, fig.height=3.5, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
table_67_chart <- table_67_series
colnames(table_67_chart) <- c("Period", "Actual", "CWMA(3)")
table_63_chart <- gather(table_67_chart, Period)
colnames(table_67_chart) <- c("Period", "Series", "Value")

chart_67 <- ggplot(data = table_67_chart, aes(y = Value, x = Period, col = Series)) +
            geom_line(position = "jitter") 
        
ggdraw(switch_axis_position(chart_67 + theme_tufte() +
            theme(legend.position = "top"), axis = 'y'))
```

```{r, message=FALSE, error=FALSE, comment=FALSE, warning=FALSE, echo=FALSE}
kable(table_67, align = "r", row.names=FALSE, caption="3 Period Centered Weighted Moving Average")
```










 